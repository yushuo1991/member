=== API Testing Report ===
Generated: 2026年01月24日  2:18:29

=== 1. User Authentication APIs ===
Testing: Register new user
  POST /api/auth/register
  Status: 200
  Response: {"success":true,"data":{"id":19,"username":"testuser999","email":"test999@example.com","membershipLevel":"none"},"message":"注册成功","timestamp":"2026-01-23T18:18:27.520Z"}...

Login test:
HTTP/1.1 401 Unauthorized
Server: nginx/1.18.0 (Ubuntu)
Date: Fri, 23 Jan 2026 18:18:28 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: keep-alive
X-DNS-Prefetch-Control: on
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: camera=(), microphone=(), geolocation=()
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'self'
vary: RSC, Next-Router-State-Tree, Next-Router-Prefetch
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin

{"success":false,"data":null,"message":"账号或密码错误","timestamp":"2026-01-23T18:18:28.006Z"}

Testing: Get current user info (with auth)
  GET /api/auth/me
  Status: 200
  Response: {"success":false,"data":{"user":null},"message":"未提供认证Token","timestamp":"2026-01-23T18:18:28.454Z"}...

Testing: Get current user info (no auth)
  GET /api/auth/me
  Status: 200
  Response: {"success":false,"data":{"user":null},"message":"未提供认证Token","timestamp":"2026-01-23T18:18:28.906Z"}...

Testing: Logout user
  POST /api/auth/logout
  Status: 200
  Response: {"success":true,"data":null,"message":"已登出","timestamp":"2026-01-23T18:18:30.167Z"}...

=== 2. Product Gate APIs ===
Testing: Gate check for circle (short slug)
  GET /api/gate/circle
  Status: 404
  Response: Not Found...

Testing: Gate check for xuexiquan (full slug)
  GET /api/gate/xuexiquan
  Status: 401
  Response: Unauthorized...

Testing: Gate check for bk (short slug)
  GET /api/gate/bk
  Status: 404
  Response: Not Found...

Testing: Gate check for bankuaijiezou (full slug)
  GET /api/gate/bankuaijiezou
  Status: 401
  Response: Unauthorized...

Testing: Gate check for xinli
  GET /api/gate/xinli
  Status: 401
  Response: Unauthorized...

Testing: Gate check for fuplan
  GET /api/gate/fuplan
  Status: 401
  Response: Unauthorized...

=== 3. Products API ===
Testing: List all products
  GET /api/products
  Status: 404
  Response: <!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/cs...

=== 4. Admin Authentication ===
Admin login test:
HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Fri, 23 Jan 2026 18:18:34 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: keep-alive
Vary: Accept-Encoding
X-DNS-Prefetch-Control: on
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: camera=(), microphone=(), geolocation=()
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'self'
vary: RSC, Next-Router-State-Tree, Next-Router-Prefetch
set-cookie: admin_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjMsInVzZXJuYW1lIjoiYWRtaW4iLCJlbWFpbCI6ImFkbWluQG1lbWJlci1zeXN0ZW0ubG9jYWwiLCJ0eXBlIjoiYWRtaW4iLCJpYXQiOjE3NjkxOTIzMTQsImV4cCI6MTc2OTc5NzExNH0.7vFMNzJYWFJ-zxfQDuX6fi0D6EQlmqofqAdOLz1ABBg; HttpOnly; SameSite=Strict; Path=/; Max-Age=604800
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin

{"success":true,"data":{"admin":{"id":3,"username":"admin","email":"admin@member-system.local","role":"super_admin"},"token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjMsInVzZXJuYW1lIjoiYWRtaW4iLCJlbWFpbCI6ImFkbWluQG1lbWJlci1zeXN0ZW0ubG9jYWwiLCJ0eXBlIjoiYWRtaW4iLCJpYXQiOjE3NjkxOTIzMTQsImV4cCI6MTc2OTc5NzExNH0.7vFMNzJYWFJ-zxfQDuX6fi0D6EQlmqofqAdOLz1ABBg"},"message":"Admin login success","timestamp":"2026-01-23T18:18:34.319Z"}

=== 5. Admin APIs ===
Testing: Get dashboard stats
  GET /api/admin/dashboard/stats
  Status: 500
  Response: {"success":false,"data":null,"message":"获取统计数据失败","timestamp":"2026-01-23T18:18:34.771Z"}...

Testing: List all members
  GET /api/admin/members
  Status: 500
  Response: {"success":false,"data":null,"message":"查询会员列表失败","timestamp":"2026-01-23T18:18:35.481Z"}...

Testing: List activation codes
  GET /api/admin/codes/list
  Status: 200
  Response: {"success":true,"data":{"codes":[{"id":58,"code":"8ECU-RSU7-GNPC-MC5P","level":"lifetime","duration_days":36500,"used":1,"used_by":9,"used_at":"2026-01-15T01:11:51.000Z","created_at":"2026-01-14T16:20...

Testing: Generate activation code
  POST /api/activation/generate
  Status: 400
  Response: {"success":false,"data":null,"message":"会员等级和数量不能为空","timestamp":"2026-01-23T18:18:36.778Z"}...

=== 6. Unauthorized Access Tests ===
Testing: Get dashboard stats (no auth)
  GET /api/admin/dashboard/stats
  Status: 401
  Response: {"success":false,"data":null,"message":"未提供管理员认证Token","timestamp":"2026-01-23T18:18:37.219Z"}...

Testing: List members (no auth)
  GET /api/admin/members
  Status: 401
  Response: {"success":false,"data":null,"message":"未提供管理员认证Token","timestamp":"2026-01-23T18:18:37.697Z"}...


=== Test Summary ===
Full report saved to: api-test-report.txt
