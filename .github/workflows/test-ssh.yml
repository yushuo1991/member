name: ğŸ§ª SSHè¿æ¥æµ‹è¯•ï¼ˆè¯Šæ–­ç”¨ï¼‰

on:
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘

jobs:
  test-ssh:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€æŸ¥Secretsé…ç½®
        run: |
          echo "========================================="
          echo "æ£€æŸ¥GitHub Secretsé…ç½®"
          echo "========================================="
          echo "SERVER_HOST: ${{ secrets.SERVER_HOST != '' && 'âœ… å·²é…ç½®' || 'âŒ æœªé…ç½®' }}"
          echo "SERVER_USER: ${{ secrets.SERVER_USER != '' && 'âœ… å·²é…ç½®' || 'âŒ æœªé…ç½®' }}"
          echo "SERVER_SSH_KEY: ${{ secrets.SERVER_SSH_KEY != '' && 'âœ… å·²é…ç½®' || 'âŒ æœªé…ç½®' }}"
          echo ""
          echo "SERVER_HOSTå€¼: ${{ secrets.SERVER_HOST }}"
          echo "SERVER_USERå€¼: ${{ secrets.SERVER_USER }}"
          echo "SSH_KEYé•¿åº¦: $(echo '${{ secrets.SERVER_SSH_KEY }}' | wc -c)"
          echo ""

      - name: æµ‹è¯•SSHè¿æ¥ - æ–¹æ³•1 (appleboy/ssh-action)
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          port: 22
          script: |
            echo "========================================="
            echo "âœ… SSHè¿æ¥æˆåŠŸï¼"
            echo "æœåŠ¡å™¨: $(hostname)"
            echo "æ—¶é—´: $(date)"
            echo "ç”¨æˆ·: $(whoami)"
            echo "========================================="

      - name: æµ‹è¯•æ‰§è¡Œç®€å•å‘½ä»¤
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          port: 22
          script: |
            cd /root/member-system
            pwd
            ls -la | head -5
            git status
